webpackJsonp([1],{D8LU:function(e,t){},FvOH:function(e,t){},KwFe:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={};s.d(o,"login",function(){return B}),s.d(o,"logout",function(){return K}),s.d(o,"getsite",function(){return j}),s.d(o,"delsite",function(){return Q}),s.d(o,"addsite",function(){return Z}),s.d(o,"upsite",function(){return J}),s.d(o,"getftp",function(){return X}),s.d(o,"addftp",function(){return ee}),s.d(o,"delftp",function(){return te}),s.d(o,"upftp",function(){return se}),s.d(o,"getmysql",function(){return oe}),s.d(o,"addmysql",function(){return ne}),s.d(o,"delmysql",function(){return ae}),s.d(o,"upmysql",function(){return re}),s.d(o,"gethome",function(){return ie}),s.d(o,"getsoft",function(){return le}),s.d(o,"upsoft",function(){return ce}),s.d(o,"addssl",function(){return me}),s.d(o,"changepwd",function(){return fe});var n=s("xd7I"),a=s("jsbU"),r=s.n(a),i=(s("D8LU"),{name:"App",data:function(){return{navList:[{id:1,title:"首页",name:"Home"},{id:2,title:"站点",name:"Site"},{id:3,title:"FTP",name:"Ftp"},{id:4,title:"MYSQL",name:"Mysql"},{id:5,title:"软件",name:"Soft"}],activeIndex:""}},methods:{handleSelect:function(e,t){},logout:function(){console.log("logout"),localStorage.clear(),this.$store.dispatch("accountLogout")}},computed:{userInfo:function(){return this.$store.state.userInfo}}}),l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[e.userInfo.token?s("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},[e._l(e.navList,function(t){return s("el-menu-item",{key:t.id,attrs:{index:"item.id"}},[s("router-link",{attrs:{to:{name:t.name}}},[e._v(e._s(t.title))])],1)}),e._v(" "),s("el-menu-item",[s("a",{attrs:{href:""},on:{click:e.logout}},[e._v("退出")])])],2):e._e(),e._v(" "),s("router-view")],1)},staticRenderFns:[]};var c=s("C7Lr")(i,l,!1,function(e){s("rHZV")},null,null).exports,m=s("e1F6"),f={name:"Home",data:function(){return{timer:null,loadavg:{},sysinfo:{},diskinfo:{},netinfo:{net_in:{eth0:"loading"},net_out:{eth0:"loading"}},dialogFormVisible:!1,repasswdform:{},formLabelWidth:"120px"}},methods:{getloadavg:function(e){var t=this;this.$http.gethome(e).then(function(s){0===s.errcode&&("sysinfo"==e?t.sysinfo=s.data:"loadavg"==e?t.loadavg=s.data:"diskinfo"==e?t.diskinfo=s.data:"netinfo"==e&&(t.netinfo=s.data))}).catch(function(e){console.log(e)})},repasswd:function(){this.dialogFormVisible=!0,this.repasswdform={}},repasswd2:function(){var e=this;this.dialogFormVisible=!1,this.$http.changepwd(this.repasswdform).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&e.$alert("密码修改成功,不过需要重新登录","重新登录",{confirmButtonText:"确定",callback:function(t){e.$store.dispatch("accountLogout").then(function(){localStorage.clear(),location.reload()})}})}).catch(function(e){e.response})}},computed:{userInfo:function(){return this.$store.state.userInfo}},created:function(){var e=this;this.getloadavg("sysinfo"),this.getloadavg("loadavg"),this.getloadavg("diskinfo"),this.timer=setInterval(function(){e.getloadavg("loadavg"),e.getloadavg("netinfo")},5e3)},destroyed:function(){clearInterval(this.timer)},components:{}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[s("span",{staticClass:"el-icon-user-solid",on:{click:e.repasswd}},[e._v(e._s(e.userInfo.username))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("负 载 "+e._s(e.loadavg.one)+" "+e._s(e.loadavg.five)+" "+e._s(e.loadavg.fifteen))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("eth0发送流量 "+e._s(e.netinfo.net_out.eth0)+" eth0接收流量 "+e._s(e.netinfo.net_in.eth0))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("CPU "+e._s(e.sysinfo.cputype)+" 核心 "+e._s(e.sysinfo.cpunum))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("内存总大小 "+e._s(e.sysinfo.memtotal)+" 可用 "+e._s(e.sysinfo.memfree)+" 使用率 "+e._s(e.sysinfo.mempercent))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("根分区 总大小 "+e._s(e.diskinfo.datotal)+" 可用 "+e._s(e.diskinfo.dafree)+" 使用率 "+e._s(e.diskinfo.dapercent))]),e._v(" "),s("el-dialog",{attrs:{title:"修改密码",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.repasswdform}},[s("el-form-item",{attrs:{label:"原密码","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.repasswdform.oldpasswd,callback:function(t){e.$set(e.repasswdform,"oldpasswd",t)},expression:"repasswdform.oldpasswd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"新密码","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.repasswdform.newpasswd,callback:function(t){e.$set(e.repasswdform,"newpasswd",t)},expression:"repasswdform.newpasswd"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("返 回")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.repasswd2}},[e._v("修 改")])],1)],1)],1)},staticRenderFns:[]};var d=s("C7Lr")(f,u,!1,function(e){s("Qlg2")},null,null).exports,p={name:"Site",data:function(){return{is_sitelist:!0,sitelistData:[],pages:1,num:5,page:1,total:1,search:"",nid:"",is_create:!0,is_update:!1,form:{site_name:"",bind_domain:"",root_path:"",is_ssl:!1,set_301:!1,domain_301:"",crt:"",key:"",is_log:!1,log_path:"",set_404:!1,deny_ua:!0,deny_referer:!0,safe:!0,cache:!0},form2:{site_info:{extra_kwargs:{}}},source:null}},methods:{cancelQuest:function(){"function"==typeof this.source&&this.source("终止请求")},handleCurrentChange:function(e){this.page=e,console.log(this.page),this.onGetsite()},onGetsite:function(){var e=this,t={nid:this.nid,page:this.page};this.$http.getsite(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.sitelistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_sitelist=!1))}).catch(function(e){console.log(e)})},handleEdit:function(e){this.nid=e,this.onGetsite()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delsite(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){var s=e.data;console.log(s),t.onGetsite()}}).catch(function(e){e.response?t.errmsg=e.response.data.errmsg:console.log(e.message),console.log(e.config)})},onUpsite:function(){var e=this,t={nid:this.nid,site_name:this.form2.site_name,root_path:this.form2.root_path,bind_domain:this.form2.bind_domain,site_info:{is_ssl:this.form2.site_info.is_ssl,php_ver:this.form2.site_info.php_ver,is_log:this.form2.site_info.is_log,log_path:this.form2.site_info.log_path,domain_301:this.form2.site_info.domain_301,extra_kwargs:{rewrite:"",set_301:this.form2.site_info.extra_kwargs.set_301,set_404:this.form2.site_info.extra_kwargs.set_404,deny_ua:this.form2.site_info.extra_kwargs.deny_ua,deny_referer:this.form2.site_info.extra_kwargs.deny_referer,safe:this.form2.site_info.extra_kwargs.safe,cache:this.form2.site_info.extra_kwargs.cache}}};this.$http.upsite(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"更新站点成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_sitelist=!0,e.nid="",e.onGetsite()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},onAddsite:function(){var e=this;if(this.form.is_ssl){var t=new FormData;t.append("crt",this.form.crt),t.append("key",this.form.key),t.append("site_name",this.form.site_name),t.append("bind_domain",this.form.bind_domain),this.$http.addssl(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){var s=t.data;e.onAddsite2(),console.log(s)}}).catch(function(e){e.response})}else this.onAddsite2()},onAddsite2:function(){var e=this;if(this.form.is_log)var t="/home/weblogs/"+this.form.site_name;else t="";var s={site_name:this.form.site_name,root_path:"/home/wwwroot/"+this.form.root_path,bind_domain:this.form.bind_domain,site_info:{is_ssl:this.form.is_ssl,php_ver:this.form.php_ver,is_log:this.form.is_log,log_path:t,domain_301:this.form.domain_301,extra_kwargs:{rewrite:"",set_301:this.form.set_301,set_404:this.form.set_404,deny_ua:this.form.deny_ua,deny_referer:this.form.deny_referer,safe:this.form.safe,cache:this.form.cache}}};this.$http.addsite(s).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"创建站点成功",type:"success"}),e.onGetsite()}}).catch(function(e){e.response})},onGetinfo:function(){this.form.root_path=this.form.site_name,this.form.bind_domain=this.form.site_name+".top,www."+this.form.site_name+".top"},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_sitelist=!0,this.onGetsite(this.nid)}},created:function(){this.onGetsite()}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"site"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_sitelist,expression:"is_sitelist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.sitelistData}},[s("el-table-column",{attrs:{label:"站点名",prop:"site_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"网站根目录",prop:"root_path"}}),e._v(" "),s("el-table-column",{attrs:{label:"绑定域名",prop:"bind_domain"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_sitelist,expression:"is_sitelist"}],staticStyle:{"margin-top":"20px","text-align":"center"}},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.num,"page-count":e.pages},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"站点名"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},nativeOn:{keyup:function(t){return e.onGetinfo(t)}},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"绑定域名"}},[s("el-input",{attrs:{placeholder:"多个域名以英文逗号,分隔"},model:{value:e.form.bind_domain,callback:function(t){e.$set(e.form,"bind_domain",t)},expression:"form.bind_domain"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站根目录"}},[s("el-input",{attrs:{placeholder:"默认/home/wwwroot/站点名"},model:{value:e.form.root_path,callback:function(t){e.$set(e.form,"root_path",t)},expression:"form.root_path"}},[s("template",{slot:"prepend"},[e._v("/home/wwwroot/")])],2)],1),e._v(" "),s("el-form-item",{attrs:{label:"PHP版本"}},[s("el-select",{attrs:{placeholder:"请选择PHP版本"},model:{value:e.form.php_ver,callback:function(t){e.$set(e.form,"php_ver",t)},expression:"form.php_ver"}},[s("el-option",{attrs:{label:"php5.6",value:"php5.6"}}),e._v(" "),s("el-option",{attrs:{label:"php7.0",value:"php7.0"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开启SSL"}},[s("el-switch",{model:{value:e.form.is_ssl,callback:function(t){e.$set(e.form,"is_ssl",t)},expression:"form.is_ssl"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.is_ssl,expression:"form.is_ssl"}],attrs:{label:"crt的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----"},model:{value:e.form.crt,callback:function(t){e.$set(e.form,"crt",t)},expression:"form.crt"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.is_ssl,expression:"form.is_ssl"}],attrs:{label:"key的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN RSA PRIVATE KEY----- ... -----END RSA PRIVATE KEY-----"},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启301"}},[s("el-switch",{model:{value:e.form.set_301,callback:function(t){e.$set(e.form,"set_301",t)},expression:"form.set_301"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.set_301,expression:"form.set_301"}],attrs:{label:"跳转的域名"}},[s("el-input",{attrs:{placeholder:"请输入301目标地址,比如www.ropon.top"},model:{value:e.form.domain_301,callback:function(t){e.$set(e.form,"domain_301",t)},expression:"form.domain_301"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启日志"}},[s("el-switch",{model:{value:e.form.is_log,callback:function(t){e.$set(e.form,"is_log",t)},expression:"form.is_log"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"额外设置"}},[e._v("\n      开启404错误页\n      "),s("el-switch",{model:{value:e.form.set_404,callback:function(t){e.$set(e.form,"set_404",t)},expression:"form.set_404"}}),e._v("屏蔽非常见UA\n      "),s("el-switch",{model:{value:e.form.deny_ua,callback:function(t){e.$set(e.form,"deny_ua",t)},expression:"form.deny_ua"}}),e._v("启用防盗链\n      "),s("el-switch",{model:{value:e.form.deny_referer,callback:function(t){e.$set(e.form,"deny_referer",t)},expression:"form.deny_referer"}}),e._v("安全加固\n      "),s("el-switch",{model:{value:e.form.safe,callback:function(t){e.$set(e.form,"safe",t)},expression:"form.safe"}}),e._v("开启缓存\n      "),s("el-switch",{model:{value:e.form.cache,callback:function(t){e.$set(e.form,"cache",t)},expression:"form.cache"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站备注"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddsite}},[e._v("创建站点")]),e._v(" "),s("el-button",[e._v("取消")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"站点名"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.site_name,callback:function(t){e.$set(e.form2,"site_name",t)},expression:"form2.site_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"绑定域名"}},[s("el-input",{attrs:{placeholder:"多个域名以英文逗号,分隔"},model:{value:e.form2.bind_domain,callback:function(t){e.$set(e.form2,"bind_domain",t)},expression:"form2.bind_domain"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站根目录"}},[s("el-input",{attrs:{placeholder:"必须是/home/wwwroot/xxxx",disabled:""},model:{value:e.form2.root_path,callback:function(t){e.$set(e.form2,"root_path",t)},expression:"form2.root_path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"PHP版本"}},[s("el-select",{attrs:{placeholder:"请选择PHP版本"},model:{value:e.form2.site_info.php_ver,callback:function(t){e.$set(e.form2.site_info,"php_ver",t)},expression:"form2.site_info.php_ver"}},[s("el-option",{attrs:{label:"php5.6",value:"php5.6"}}),e._v(" "),s("el-option",{attrs:{label:"php7.0",value:"php7.0"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开启SSL"}},[s("el-switch",{model:{value:e.form2.site_info.is_ssl,callback:function(t){e.$set(e.form2.site_info,"is_ssl",t)},expression:"form2.site_info.is_ssl"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启301"}},[s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.set_301,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"set_301",t)},expression:"form2.site_info.extra_kwargs.set_301"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form2.site_info.extra_kwargs.set_301,expression:"form2.site_info.extra_kwargs.set_301"}],attrs:{label:"跳转的域名"}},[s("el-input",{model:{value:e.form2.site_info.domain_301,callback:function(t){e.$set(e.form2.site_info,"domain_301",t)},expression:"form2.site_info.domain_301"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启日志"}},[s("el-switch",{model:{value:e.form2.site_info.is_log,callback:function(t){e.$set(e.form2.site_info,"is_log",t)},expression:"form2.site_info.is_log"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"额外设置"}},[e._v("\n      开启404错误页\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.set_404,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"set_404",t)},expression:"form2.site_info.extra_kwargs.set_404"}}),e._v("屏蔽非常见UA\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.deny_ua,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"deny_ua",t)},expression:"form2.site_info.extra_kwargs.deny_ua"}}),e._v("启用防盗链\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.deny_referer,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"deny_referer",t)},expression:"form2.site_info.extra_kwargs.deny_referer"}}),e._v("安全加固\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.safe,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"safe",t)},expression:"form2.site_info.extra_kwargs.safe"}}),e._v("开启缓存\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.cache,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"cache",t)},expression:"form2.site_info.extra_kwargs.cache"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站备注"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form2.note,callback:function(t){e.$set(e.form2,"note",t)},expression:"form2.note"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onUpsite}},[e._v("更新站点")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var h=s("C7Lr")(p,_,!1,function(e){s("t1vM")},"data-v-67bbb19e",null).exports,g={name:"Ftp",data:function(){return{ftplistData:[],nid:"",search:"",is_ftplist:!0,is_create:!0,is_update:!1,form:{ftp_user:"",ftp_path:""},form2:{}}},methods:{ongetFtp:function(){var e=this;this.$http.getftp(this.nid).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.ftplistData=t.data,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_ftplist=!1))}).catch(function(e){console.log(e)})},onAddFtp:function(){var e=this;if(""!=this.form.ftp_path)var t="/home/wwwroot/"+this.form.ftp_path;else t="";var s={ftp_user:this.form.ftp_user,ftp_passwd:this.form.ftp_passwd,ftp_path:t};this.$http.addftp(s).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"创建站点成功",type:"success"}),e.ongetFtp()}}).catch(function(t){t.response?e.$message.error(t.response.data.errmsg):console.log(t.message),console.log(t.config)})},handleEdit:function(e){this.nid=e,this.ongetFtp()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delftp(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){e.data;t.ongetFtp()}}).catch(function(e){e.response?t.errmsg=e.response.data.errmsg:console.log(e.message),console.log(e.config)})},onupFtp:function(){var e=this,t={nid:this.nid,ftp_user:this.form2.ftp_user,ftp_passwd:this.form2.ftp_passwd,ftp_path:this.form2.ftp_path,status:this.form2.status};this.$http.upftp(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"更新站点成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_ftplist=!0,e.nid="",e.ongetFtp()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_ftplist=!0,this.ongetFtp()}},created:function(){this.ongetFtp()}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ftp"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_ftplist,expression:"is_ftplist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.ftplistData}},[s("el-table-column",{attrs:{label:"FTP用户名",prop:"ftp_user"}}),e._v(" "),s("el-table-column",{attrs:{label:"FTP密码",prop:"ftp_passwd"}}),e._v(" "),s("el-table-column",{attrs:{label:"路径",prop:"ftp_path"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"FTP名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.ftp_user,callback:function(t){e.$set(e.form,"ftp_user",t)},expression:"form.ftp_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.ftp_passwd,callback:function(t){e.$set(e.form,"ftp_passwd",t)},expression:"form.ftp_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP根目录"}},[s("el-input",{attrs:{placeholder:"默认是/home/wwwroot/FTP用户名"},model:{value:e.form.ftp_path,callback:function(t){e.$set(e.form,"ftp_path",t)},expression:"form.ftp_path"}},[s("template",{slot:"prepend"},[e._v("/home/wwwroot/")])],2)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddFtp}},[e._v("创建站点")]),e._v(" "),s("el-button",[e._v("取消")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"FTP名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.ftp_user,callback:function(t){e.$set(e.form2,"ftp_user",t)},expression:"form2.ftp_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form2.ftp_passwd,callback:function(t){e.$set(e.form2,"ftp_passwd",t)},expression:"form2.ftp_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP根目录"}},[s("el-input",{attrs:{placeholder:"",disabled:""},model:{value:e.form2.ftp_path,callback:function(t){e.$set(e.form2,"ftp_path",t)},expression:"form2.ftp_path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启/关闭"}},[s("el-switch",{model:{value:e.form2.status,callback:function(t){e.$set(e.form2,"status",t)},expression:"form2.status"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onupFtp}},[e._v("更新站点")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var b=s("C7Lr")(g,v,!1,function(e){s("FvOH")},"data-v-64815ba4",null).exports,w=s("a3Yh"),y=s.n(w),k={name:"Mysql",data:function(){return y()({mysqllistData:[],nid:"",search:"",form:{mysql_user:""},form2:{},is_mysqllist:!0,is_create:!0,is_update:!1},"nid","")},methods:{ongetMysql:function(){var e=this;this.$http.getmysql(this.nid).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.mysqllistData=t.data,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_mysqllist=!1))}).catch(function(e){console.log(e)})},onAddMysql:function(){var e=this,t={mysql_user:this.form.mysql_user,mysql_name:this.form.mysql_name,mysql_passwd:this.form.mysql_passwd,accept:this.form.accept};this.$http.addmysql(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"创建数据库成功",type:"success"}),e.ongetMysql()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},handleEdit:function(e){this.nid=e,this.ongetMysql()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delmysql(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){e.data;t.ongetMysql()}}).catch(function(e){e.response?t.errmsg=e.response.data.errmsg:console.log(e.message),console.log(e.config)})},onupMysql:function(){var e=this,t={nid:this.nid,mysql_passwd:this.form2.mysql_passwd,accept:this.form2.accept};this.$http.upmysql(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"更新数据库成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_mysqllist=!0,e.nid="",e.ongetMysql()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_mysqllist=!0,this.ongetMysql(this.nid)}},created:function(){this.ongetMysql(this.nid)}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ftp"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_mysqllist,expression:"is_mysqllist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.mysqllistData}},[s("el-table-column",{attrs:{label:"Mysql用户名",prop:"mysql_user"}}),e._v(" "),s("el-table-column",{attrs:{label:"Mysql数据库",prop:"mysql_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"Mysql密码",prop:"mysql_passwd"}}),e._v(" "),s("el-table-column",{attrs:{label:"连接地址",prop:"accept"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"Mysql用户名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysql_user,callback:function(t){e.$set(e.form,"mysql_user",t)},expression:"form.mysql_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql数据库 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysql_name,callback:function(t){e.$set(e.form,"mysql_name",t)},expression:"form.mysql_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.mysql_passwd,callback:function(t){e.$set(e.form,"mysql_passwd",t)},expression:"form.mysql_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"连接方式 "}},[s("el-input",{attrs:{placeholder:"%/localhost/ip地址"},model:{value:e.form.accept,callback:function(t){e.$set(e.form,"accept",t)},expression:"form.accept"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddMysql}},[e._v("创建数据库")]),e._v(" "),s("el-button",[e._v("返回")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"Mysql用户名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.mysql_user,callback:function(t){e.$set(e.form2,"mysql_user",t)},expression:"form2.mysql_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql数据库 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.mysql_name,callback:function(t){e.$set(e.form2,"mysql_name",t)},expression:"form2.mysql_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form2.mysql_passwd,callback:function(t){e.$set(e.form2,"mysql_passwd",t)},expression:"form2.mysql_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"连接方式 "}},[s("el-input",{attrs:{placeholder:"%/localhost/ip地址"},model:{value:e.form2.accept,callback:function(t){e.$set(e.form2,"accept",t)},expression:"form2.accept"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onupMysql}},[e._v("更新数据库")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var $=s("C7Lr")(k,x,!1,function(e){s("s/xj")},"data-v-7bf62020",null).exports,q={name:"Soft",data:function(){return{nid:"",sotlistData:[],search:"",dialogFormVisible:!1,installform:{nid:"",soft_name:"",installtype:""},form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},formLabelWidth:"120px"}},methods:{onGetsoft:function(){var e=this;this.$http.getsoft(this.nid).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.sotlistData=t.data)}).catch(function(e){console.log(e)})},handleInstall:function(e,t,s){this.dialogFormVisible=!0,this.installform.nid=e,this.installform.soft_name=t+s,this.installform.installtype="rpm"},handleUninstall:function(){},InstallSoft:function(){var e=this;this.dialogFormVisible=!1,console.log(this.installform),this.$http.upsoft(this.installform).then(function(t){if(0===t.errcode){t.data;e.$message({message:t.errmsg,type:"success"}),e.onGetsoft()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})}},created:function(){this.onGetsoft()}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.sotlistData}},[s("el-table-column",{attrs:{label:"名称",prop:"soft_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"版本",prop:"soft_ver"}}),e._v(" "),s("el-table-column",{attrs:{label:"描述",prop:"soft_desc"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_install?s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-remove"},on:{click:function(s){return e.handleUninstall(t.row.nid)}}},[e._v("卸载")]):s("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus"},on:{click:function(s){return e.handleInstall(t.row.nid,t.row.soft_name,t.row.soft_ver)}}},[e._v("安装")])]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("el-dialog",{attrs:{title:"安装方式",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.installform}},[s("el-form-item",{attrs:{label:"软件名称","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.installform.soft_name,callback:function(t){e.$set(e.installform,"soft_name",t)},expression:"installform.soft_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"安装方式","label-width":e.formLabelWidth}},[s("el-radio",{attrs:{label:"rpm"},model:{value:e.installform.installtype,callback:function(t){e.$set(e.installform,"installtype",t)},expression:"installform.installtype"}},[e._v("极速")]),e._v(" "),s("el-radio",{attrs:{label:"bash"},model:{value:e.installform.installtype,callback:function(t){e.$set(e.installform,"installtype",t)},expression:"installform.installtype"}},[e._v("编译")])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.InstallSoft}},[e._v("安 装")])],1)],1)],1)},staticRenderFns:[]};var S=s("C7Lr")(q,F,!1,function(e){s("fL2T")},null,null).exports,I={name:"Login",data:function(){return{username:"",password:""}},methods:{onLogin:function(){var e=this,t={username:this.username,password:this.password};this.$http.login(t).then(function(t){if(0===t.errcode){var s=t.data.username,o=t.data.token;localStorage.setItem("username",s),localStorage.setItem("token",o);var n={token:localStorage.getItem("token"),username:localStorage.getItem("username")};e.$store.dispatch("getUserInfo",n),e.$message({message:"登录成功",type:"success"}),e.$router.go(-1)}else e.$message.error(t.errmsg)}).catch(function(e){console.log(e)})}},components:{}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("div",{staticStyle:{width:"60%","margin-top":"20px","text-align":"center"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("el-input",{staticStyle:{"margin-top":"20px"},attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onLogin(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.onLogin}},[e._v("登 录")])],1)])},staticRenderFns:[]};var C=s("C7Lr")(I,L,!1,function(e){s("sY/O")},null,null).exports,M={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("p",[this._v("404 - Not Found")])])}]};s("C7Lr")({name:"NotFound",data:function(){}},M,!1,function(e){s("WUic")},"data-v-39a15432",null).exports;n.default.use(m.a);var E=new m.a({mode:"history",routes:[{path:"/",name:"Home",component:d,meta:{requiresAuth:!0}},{path:"/site",name:"Site",component:h,meta:{requiresAuth:!0}},{path:"/ftp",name:"Ftp",component:b,meta:{requiresAuth:!0}},{path:"/mysql",name:"Mysql",component:$,meta:{requiresAuth:!0}},{path:"/soft",name:"Soft",component:S,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:C}]}),A=(s("KwFe"),s("2bvH"));n.default.use(A.a);var D=new A.a.Store({state:{userInfo:{}},mutations:{getUserInfo:function(e,t){e.userInfo=t},accountLogout:function(e){e.userInfo={}}},actions:{getUserInfo:function(e,t){(0,e.commit)("getUserInfo",t)},accountLogout:function(e){(0,e.commit)("accountLogout")}}}),P=s("84iU"),T=s.n(P),N=s("KPSb"),U=s.n(N);T.a.defaults.baseURL="http://"+window.location.host+"/api/v1",T.a.defaults.timeout=3e3;var V="/login",G="/site",R="/ftp",z="/mysql",H="/home",O="/soft",W="/ssl",Y="/user";function B(e){return T.a.post(V,e).then(function(e){return e.data})}function K(e){return T.a.post(V,e).then(function(e){return e.data})}function j(e){return T.a.get(G,{params:e}).then(function(e){return e.data})}function Q(e){return T.a.delete(G,{data:e}).then(function(e){return e.data})}function Z(e){return T.a.post(G,e).then(function(e){return e.data})}function J(e){return T.a.put(G,e).then(function(e){return e.data})}function X(e){return T.a.get(R+"?nid="+e).then(function(e){return e.data})}function ee(e){return T.a.post(R,e).then(function(e){return e.data})}function te(e){return T.a.delete(R,{data:e}).then(function(e){return e.data})}function se(e){return T.a.put(R,e).then(function(e){return e.data})}function oe(e){return T.a.get(z+"?nid="+e).then(function(e){return e.data})}function ne(e){return T.a.post(z,e).then(function(e){return e.data})}function ae(e){return T.a.delete(z,{data:e}).then(function(e){return e.data})}function re(e){return T.a.put(z,e).then(function(e){return e.data})}function ie(e){return T.a.get(H+"?info="+e).then(function(e){return e.data})}function le(e){return T.a.get(O+"?nid="+e).then(function(e){return e.data})}function ce(e){return T.a.put(O,e).then(function(e){return e.data})}function me(e){return T.a.post(W,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){return e.data})}function fe(e){return T.a.post(Y,e).then(function(e){return e.data})}T.a.interceptors.request.use(function(e){var t=localStorage.getItem("username"),s=localStorage.getItem("token");if(t&&s){var o=Math.round((new Date).getTime()/1e3);e.headers.otime=o,e.headers.username=t,e.headers.accesstoken=U()(t+o.toString()+s)}return e},function(e){a.Message.error({message:"请求超时!"})}),T.a.interceptors.response.use(function(e){return 4023!=e.data.errcode&&4024!=e.data.errcode&&4026!=e.data.errcode||a.MessageBox.alert("你已被登出,请重新登录","重新登录",{confirmButtonText:"确定",callback:function(e){D.dispatch("accountLogout").then(function(){localStorage.clear(),location.reload()})}}),e},function(e){400==e.response.status?a.Message.error({message:e.response.data.errmsg}):a.Message.error({message:"未知错误!"})}),n.default.prototype.$http=o,n.default.prototype.$md5=U.a,n.default.config.productionTip=!1,n.default.use(r.a),E.beforeEach(function(e,t,s){if(e.meta.requiresAuth)if(localStorage.getItem("token")){var o={token:localStorage.getItem("token"),username:localStorage.getItem("username")};D.dispatch("getUserInfo",o),s()}else s({name:"Login"});else s()}),new n.default({el:"#app",router:E,store:D,components:{App:c},template:"<App/>"})},Qlg2:function(e,t){},WUic:function(e,t){},fL2T:function(e,t){},rHZV:function(e,t){},"s/xj":function(e,t){},"sY/O":function(e,t){},t1vM:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.ee620f9079eaa502b135.js.map